# Cost Analytics in Atlas

Atlas provides a Cost Analytics feature that allows administrators to monitor and analyze OpenAI API usage across the platform. This documentation explains how to use the Cost Analytics feature and how it works behind the scenes.

## Accessing Cost Analytics

The Cost Analytics feature is accessible from the Insights page. To access it:

1. Log in as an administrator
2. Navigate to the Insights page
3. Click on the "Cost Analytics" tab

## Features

### Usage Metrics Overview

The Cost Analytics dashboard provides detailed usage metrics for OpenAI API services:

- **Completions**:
  - Input tokens: Number of tokens sent to the API
  - Output tokens: Number of tokens generated by the API
  - Cost: Total cost for chat completions and text generation

- **Embeddings**:
  - Input tokens: Number of tokens processed for embeddings
  - Cost: Total cost for embedding generation

- **Vector Stores**:
  - Storage: Amount of data stored in vector databases (in bytes/KB/MB)
  - Cost: Total cost for vector storage

### Date Range Selection

You can analyze usage for a specific time period by using the date range selector at the top of the page. This allows you to:

- View metrics for specific time periods
- Compare usage across different time frames
- Track usage trends over time

### Usage Trend Visualization

The Cost Analytics dashboard includes multiple charts that visualize your usage:

- **Completions Token Usage**: Bar chart showing input and output token usage per day
- **Daily Cost Trends**: Line chart showing daily costs across all services

These visualizations help you identify:
- Days with high token usage
- Usage patterns over time
- Distribution of costs across different API features

## Technical Implementation

### API Integration

The Cost Analytics feature integrates with several OpenAI API endpoints:

```
GET https://api.openai.com/v1/organization/costs
GET https://api.openai.com/v1/organization/usage/completions
GET https://api.openai.com/v1/organization/usage/vector_stores
```

These endpoints provide detailed information about costs and usage metrics across your OpenAI organization.

### Fallback to Simulated Data

If your OpenAI account doesn't have access to the organization usage APIs (which require special permissions), the system falls back to simulated data that demonstrates the feature's capabilities. This simulated data includes:

- Realistic token usage patterns
- Appropriate vector storage metrics
- Lower, more realistic costs
- Reduced usage on weekends
- Variations between different services

### Data Processing

The usage data (whether from the API or simulated) is processed to:

1. Extract token counts from completions data
2. Calculate storage amounts from vector store usage
3. Organize daily usage metrics
4. Generate visualizations that highlight both usage and costs

### Security and Access Control

The Cost Analytics feature is only accessible to administrators. The backend API routes implement:

- Authentication checks using NextAuth.js
- Role-based access control for admin-only features

## Future Enhancements

Future enhancements planned for the Cost Analytics feature include:

1. Project-level usage tracking and allocation
2. Token usage metrics by individual conversation
3. Cost forecasting and budget monitoring
4. Usage optimization recommendations
5. Custom date range comparisons

## Troubleshooting

If you encounter issues with the Cost Analytics feature:

1. Verify you have administrator access to view the analytics
2. Ensure your OpenAI API key is valid and properly configured
3. Check the browser console for any error messages
4. Note that the simulated data will be used if your OpenAI account lacks organization-level API access
5. For real API implementation, ensure your OpenAI account has the required organization-level permissions 